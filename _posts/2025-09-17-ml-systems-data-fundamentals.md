---
title: ML Systems Data Fundamentals
date: 2025-09-17 17:25:58 +09:00
categories: ['mlops']
tags: ['mlops', 'data storage', 'data processsing']
math: true
---

앞선 정리에서는 데이터 소스, 포맷, 모델을 중심으로  
데이터가 “어떤 형태로 저장되는가”를 살펴보았습니다.

이번 내용에서는 한 단계 더 나아가,

> 데이터가 어떤 엔진에 저장되고  
> 어떻게 처리·흐름·변환(ETL/ELT)되며  
> 이것이 ML 시스템 운영에 어떤 영향을 주는지,  
> 즉 데이터가 시스템 내부에서 실제로 움직이는 방식을 다룹니다.

ML 시스템에서 발생하는 문제의 상당수는 모델 자체가 아니라  
데이터 저장·처리 구조에서 비롯되므로,  
이 내용을 이해하는 것이 전체 시스템 설계의 핵심이라고 할 수 있습니다.

---

## 데이터 저장 엔진과 처리

데이터 포맷과 모델은 “겉모습(인터페이스)”에 해당하며,  
스토리지 엔진(데이터베이스)은 이를 실제로 디스크/메모리에 저장하고 꺼내는 구현체입니다.

전통적으로 데이터베이스는 두 가지 워크로드에 맞춰 설계되었습니다.

- 트랜잭션 처리용: OLTP (Online Transaction Processing)
- 분석 처리용: OLAP (Online Analytical Processing)

### 트랜잭션 처리 (OLTP)

디지털 환경에서의 “트랜잭션”은 다양한 사용자 행동을 의미합니다.

- 예: 트윗 작성, 택시 호출, 모델 업로드, 동영상 재생, 쇼핑 결제 등
- 패턴
  - 발생 즉시 삽입(insert)되고, 필요 시 업데이트나 삭제가 이루어짐
  - 각 트랜잭션은 다른 트랜잭션과 비교적 독립적으로 처리됨
- 요구사항
  - 낮은 지연(latency): 사용자가 기다리지 않도록 빠르게 처리해야 함
  - 높은 가용성(availability): 언제 요청하더라도 동작해야 함
- 구현 특성
  - 행(row) 단위 작업이 많아 row-major 구조와 잘 맞는 경우가 많습니다.

#### ACID

트랜잭션 데이터베이스는 일반적으로 다음 특성을 갖습니다.

- Atomicity (원자성)
  - 트랜잭션의 모든 단계가 전부 성공하거나 전부 취소되어야 합니다.
  - 예: 결제가 실패하면 기사 배정도 함께 취소되어야 합니다.
- Consistency (일관성)
  - 시스템에 정의된 규칙을 항상 만족해야 합니다.
  - 예: 존재하지 않는 사용자 ID로는 결제가 이루어질 수 없습니다.
- Isolation (고립성)
  - 동시에 수행되는 트랜잭션이 서로 영향을 주지 않아야 합니다.
  - 예: 같은 기사에게 두 사용자가 동시에 배차되는 상황을 방지합니다.
- Durability (지속성)
  - 커밋된 트랜잭션은 장애 발생 후에도 보존되어야 합니다.
  - 예: 택시 호출 후 휴대폰이 꺼져도 호출 정보는 유지되어야 합니다.

모든 시스템이 강한 ACID를 요구하는 것은 아니며, 제약이 크다고 판단될 경우  
BASE(Basically Available, Soft state, Eventual consistency)와 같은 느슨한 모델을 채택하기도 합니다.

### 분석 처리 (OLAP)

분석용 쿼리는 다음과 같은 목적을 가지고 있습니다.

- 예:
  - “9월 샌프란시스코 택시 요금 평균은?”
  - “지난 분기 상품 A의 국가별 매출은?”
- 특징
  - 많은 행에 걸쳐 집계, 통계, 그룹화 수행
  - 열(column) 기반 연산 중심, 데이터 규모가 큼
- 전통적으로
  - OLTP는 트랜잭션용 DB
  - OLAP는 별도의 데이터 웨어하우스 또는 분석 엔진이 담당했습니다.

### OLTP / OLAP 경계 약화와 스토리지–컴퓨트 분리

책에서는 OLTP/OLAP 용어가 점점 구식이 되고 있다고 설명합니다. 이유는 다음과 같습니다.

1. 기술 발전으로 두 영역이 수렴하고 있음
  - 트랜잭션 DB가 분석 쿼리도 처리 가능
  - 분석 엔진이 트랜잭션성 작업도 수행 가능
2. 스토리지와 컴퓨트(처리) 분리
  - 과거: 저장 방식 = 처리 방식
  - 현재:
    - 데이터는 공통 저장소(예: 클라우드 오브젝트 스토리지)에 저장하고
    - 다양한 처리 엔진으로 용도별 활용이 가능함
  - 예: BigQuery, Snowflake, IBM, Teradata 등
3. “Online”이라는 용어의 의미 확장
  - 인터넷 연결 의미에서 시작되었으나
  - 현재는 프로덕션 배포, 실시간 처리 등 다양한 의미로 사용됨

### Online / Nearline / Offline (데이터 가용성 기준)

최근 데이터 문맥에서 “online”은 속도 및 접근 가능성을 의미하는 경우가 많습니다.

- Online
  - 즉시 읽기/쓰기 가능
- Nearline
  - 사람 개입 없이 빠르게 online 상태로 전환 가능
  - 예: 저비용 스토리지에서 자동으로 이동 가능한 경우
- Offline
  - 사람이 개입해야 online 상태로 전환 가능
  - 예: 오프라인 백업에서 수동 복구 필요

---

## ETL(Extract–Transform–Load) 과 ELT

### ETL: Extract → Transform → Load

관계형 DB와 구조화 데이터가 중심이던 시절부터 사용된 표준 데이터 파이프라인 방식입니다.

1. Extract (추출)
  - 여러 데이터 소스에서 데이터 수집
  - 포맷 오류, 손상 데이터, 필수 필드 누락 등을 검증
  - 기준 미달 데이터는 거부하고 필요 시 소스에 알림
  - 초기에 걸러낼수록 이후 비용 절감 효과가 큼

2. Transform (변환) – 핵심 단계
  - 데이터 정제 및 통합(clean + join)
  - 값 표준화(예: 성별 표기 통일)
  - 중복 제거, 정렬, 집계, 파생 피처 생성
  - 분석/ML 활용에 적합한 구조로 변환

3. Load (적재)
  - 변환된 데이터를 형식, 주기, 저장 위치에 맞춰 저장

ETL은 “타깃 스키마를 미리 정의하고 그에 맞춰 정제하여 저장한다”는 접근을 반영합니다.

### ELT: Extract → Load → Transform

인터넷과 클라우드의 확산으로 데이터량이 폭증하면서 등장한 방식입니다.

- 데이터 도착 지연을 줄이기 위해
  - Extract 후 즉시 Data Lake에 저장
  - 필요 시 애플리케이션에서 데이터를 꺼내 변환

- 장점
  - 전처리가 거의 없어 데이터 유입이 빠름
  - 스키마 변화에 유연함
- 단점
  - Data Lake 용량 증가
  - 원시 데이터에서 필요한 데이터를 찾는 비용 증가
- 최근 흐름
  - 클라우드 인프라 표준화로 다시 구조화 저장의 필요성 증가

### Data Lake vs Warehouse vs Lakehouse

- Data Warehouse
  - 정제된 구조화 데이터 저장
  - BI, 대시보드, 분석, 모델 학습에 즉시 활용 가능
- Data Lake
  - 포맷/스키마 제약 없이 원시 데이터 저장
  - 다양한 활용 가능성을 위해 저장
- Lakehouse
  - 두 개념의 장점 결합
  - Data Lake의 유연성과 Warehouse의 관리/ACID 특성 제공
  - 동일 데이터 기반 다양한 워크로드 지원
  - 예: Databricks, Snowflake

---

## 맺음말

> ML 시스템을 제대로 이해하기 위해서는 모델뿐 아니라  
> 데이터가 어떻게 저장되고 이동하며 가공되는지를 함께 이해해야 합니다.  
> 이러한 흐름을 파악해야 전체 시스템 설계와 운영을 안정적으로 수행할 수 있습니다.  
> ML 시스템은 모델이 아니라 데이터가 흐르는 구조 위에서 동작하는 시스템입니다.
